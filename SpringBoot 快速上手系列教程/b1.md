# SpringBoot å¿«é€Ÿä¸Šæ‰‹ç³»åˆ—æ•™ç¨‹ï¼ˆä¸€ï¼‰



**SpringBoot** æ˜¯ **Spring** å®˜æ–¹ä¸ºäº†ç®€åŒ–å¼€å‘éš¾åº¦ï¼Œæå‡å¼€å‘æ•ˆç‡è€Œæ‰“ç£¨çš„ä¸€ä¸ªé€ ç¦å¼€å‘è€…çš„å…¨èƒ½æ¡†æ¶ï¼Œå¥¹å¤©ç”Ÿå°±æ˜¯ä¸ºé›†æˆè€Œæ¥ï¼Œæ–¹ä¾¿é›†æˆï¼Œå¿«é€Ÿé›†æˆï¼Œè‡ªåŠ¨é›†æˆã€‚å¥¹æä¾›äº†å¾ˆå¤šæœ¬æ˜¯ç”Ÿäº§ç¯å¢ƒæ‰å…·æœ‰çš„ç‰¹æ€§ï¼Œæ¯”å¦‚åº”ç”¨ç›‘æ§ï¼Œä»£ç çƒ­ä¿®æ”¹ç­‰ã€‚æä¾›äº†æœ€ä½³å®è·µå¦‚ï¼šä»£ç ç»“æ„ï¼Œé…ç½®ï¼Œè‡ªåŠ¨é…ç½®ï¼Œ**Spring Beans** å’Œä¾èµ–æ³¨å…¥ç­‰ã€‚ä¸ºäº†è¾¾åˆ°è¿™äº›ç®€åŒ–ã€è‡ªåŠ¨åŒ–ï¼Œå¯¹å¼€å‘äººå‘˜æå¤§çš„ä¾¿åˆ©æ€§èƒŒåï¼Œ**SpringBoot** åšäº†å¤§é‡çš„å·¥ä½œã€‚å®˜æ–¹æ˜¯è¿™æ ·ä»‹ç»çš„ï¼š

> å®˜æ–¹ä»‹ç»ï¼š

**SpringBoot** ä½¿å¾—åˆ›å»ºç‹¬ç«‹çš„ã€é¢å‘ç”Ÿäº§ç¯å¢ƒçš„ã€åŸºäº **Spring** çš„åº”ç”¨ç¨‹åºå˜å¾—æ˜“å¦‚åæŒï¼Œç®€å•åˆ°å¯ä»¥ â€œç›´æ¥è¿è¡Œâ€ è¿™äº›åº”ç”¨ç¨‹åºï¼ˆä¸»è¦æ˜¯æŒ‡ **build** è¿‡ç¨‹æ›´åŠ ç®€å•ï¼Œæ–¹ä¾¿ï¼Œæä¾›äº†åŸºäº **Mavenï¼ŒGradle** çš„ build ç»„ä»¶ï¼Œä¸€é”® build JAR ã€WARï¼ŒSpring ä¹Ÿæä¾›äº†å‘½ä»¤è¡Œï¼‰ã€‚

å¯¹äº **Spring** å¹³å°å’Œç¬¬ä¸‰æ–¹ç±»åº“ï¼Œæˆ‘ä»¬å®¢è§‚ä¸Šè®¤ä¸ºå¯ä»¥è½»æ¾åœ°å…¥é—¨ã€‚å¤§å¤šæ•°çš„ **SpringBoot** åº”ç”¨åªéœ€è¦å¾ˆå°‘çš„ **Spring** é…ç½®ï¼Œä¸åƒä¼ ç»Ÿçš„ **Spring** éœ€è¦åœ¨ XML é…ç½®æ–‡ä»¶é‡Œé…ç½®å¾ˆå¤šï¼Œæ¯”å¦‚äº‹åŠ¡é…ç½®ï¼Œæ³¨è§£æ‰«æé…ç½®ç­‰ï¼Œ**SpringBoot** éƒ½ä¼šè‡ªåŠ¨æ‰«æã€‚



> ç‰¹æ€§

1. åˆ›å»ºç‹¬ç«‹çš„ã€å•ç‹¬çš„åº”ç”¨ç¨‹åº
2. æ”¯æŒç›´æ¥åµŒå…¥å¼åº”ç”¨æœåŠ¡å™¨ï¼ˆ**Tomcat,  Jetty or Undertow**ï¼‰ï¼Œä¸éœ€è¦æ„å»º **war** éƒ¨ç½²åˆ°åº”ç”¨æœåŠ¡å™¨
3. æä¾›äº†æ–¹ä¾¿çš„çš„ â€œ**starter**â€ ä¾èµ–é¡¹æ¥ç®€åŒ–æ„å»ºé…ç½®
4. æ€»æ˜¯å°½å¯èƒ½åœ°è‡ªåŠ¨é…ç½® **Spring** å’Œç¬¬ä¸‰æ–¹ç±»åº“
5. æä¾›ç”Ÿäº§ç¯å¢ƒçš„ç‰¹æ€§ï¼Œå¦‚åº”ç”¨ç›‘æ§ã€å¥åº·æ£€æŸ¥å’Œå¤–éƒ¨åŒ–é…ç½®
6. å®Œå…¨ä¸éœ€è¦ä»£ç ç”Ÿæˆï¼Œä¹Ÿä¸éœ€è¦é¢å¤– **XML** é…ç½®



## å¿«é€Ÿä¸Šæ‰‹

å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£å¿«é€Ÿæ„å»ºä¸€ä¸ªç®€å•çš„ **SpringBoot** åº”ç”¨ï¼Œ[æˆ³è¿™é‡Œ](https://start.spring.io/)ï¼Œç„¶åä¸‹è½½ä¸‹æ¥è§£å‹ï¼Œå¯¼å…¥åˆ° **IDE** é‡Œï¼Œæ¨èä½¿ç”¨ [IDEA](https://www.jetbrains.com/idea/download/)ï¼Œåšä¸»ä¹Ÿæ˜¯ä» **Eclipse** è½¬åˆ° **IDEA** çš„ï¼Œæ¯”èµ· **Eclipse** æ¥éå¸¸å¥½ç”¨ï¼Œéå¸¸å¼ºå¤§ã€‚ æœ‰ç¤¾åŒºå…è´¹ç‰ˆï¼Œä¹Ÿæœ‰æ——èˆ°ç‰ˆï¼ˆ[å¯ä»¥æˆ³è¿™é‡ŒæŸ¥çœ‹å¦‚ä½•ç§‘å­¦ä½¿ç”¨](https://gxfcba.com/a1/softRes)ï¼‰ã€‚æ„å»ºå·¥å…·ï¼Œæœ¬ç«™åšå®¢å…¨éƒ¨ä½¿ç”¨ **[Maven](https://maven.apache.org/download.cgi)** æ„å»ºã€‚



> ç›®å½•ç»“æ„æœ€ä½³å®è·µ

[æˆ³è¿™é‡Œçœ‹ SpringBootå®˜æ–¹æ¨è](https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#working-with-spring-boot)ã€‚å»ºä¸€ä¸ªæ ¹è·¯å¾„åŒ… rootï¼Œæ¯”å¦‚ï¼šcom.gxfcbaï¼Œç„¶åæ ¹è·¯å¾„ä¸‹å»ºä¸€ä¸ªä¸»çš„ **Class**ï¼Œé€šå¸¸å°±å« `App`ï¼Œæˆ–è€…æœ‰ç‰¹å®šæ„ä¹‰çš„åå­—ï¼Œæ¯”å¦‚ `BlogApp`ï¼š

```java
package com.gxfcba;

import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.ApplicationContext;
import org.springframework.transaction.annotation.EnableTransactionManagement;

@SpringBootApplication
@EnableTransactionManagement
public class App {
    private static Logger logger = LogManager.getLogger(App.class);
    private static ApplicationContext applicationContext;

    public static void main(String[] args) {
        applicationContext = SpringApplication.run(App.class, args);

    }

    public static <T> T getBean(Class<T> clz) {
        return (T) applicationContext.getBean(clz);
    }
}

```



æœ€ç»ˆçš„ Class ç›®å½•ç»“æ„çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š

```reStructuredText
com
 +- gxfcba
    +- App.java
    |
		+- base
		|		+- ...
		+- util
		|		+- DateUtils
		|		+- ...
    |
    +- blog
    |   +- Blog.java
    |   +- BlogController.java
    |   +- BlogService.java
    |   +- BlogRepository.java
    |
    +- order
    +- ...
    ...
		...	
```



**Spring** ä¼šè‡ªåŠ¨æ‰«æ `App.java` æ‰€åœ¨ç›®å½•ä»¥åŠæ‰€æœ‰å­ç›®å½•è¢«æ·»åŠ äº†èƒ½å¤Ÿè¢«å¥¹ç®¡ç†çš„æ³¨è§£çš„ç±»ï¼Œå¦‚ï¼š**`@Component`, `@Service`, `@Repository`, `@Controller`** ç­‰ã€‚ä½¿ç”¨ä¼ ç»Ÿçš„ XML çš„è¯ï¼Œæ˜¯éœ€è¦é…ç½®è¿™ä¸ªå±æ€§çš„ï¼Œè€Œ **Springboot** ä¸ç”¨ã€‚

æ›´åŠ è¯¦ç»†çš„ä¿¡æ¯å»ºè®®è¯¦ç»†é˜…è¯» [SpringBoot å®˜æ–¹æ–‡æ¡£](https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-documentation)ï¼Œå¤šçœ‹å‡ æ¬¡ï¼Œå°±å½“å­¦ä¹ è‹±æ–‡äº†ã€‚



> `BlogController.java` 

```java
package com.gxfcba.blog;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.gxfcba.base.BaseController;
import com.gxfcba.base.MyPageRequest;
import com.gxfcba.base.MyResponse;
import org.springframework.data.domain.PageRequest;
import org.springframework.data.domain.Sort;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.servlet.ModelAndView;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

@Controller
@RequestMapping("/blog")
public class BlogController extends BaseController {

    @GetMapping()
    public ModelAndView index(@PathVariable(required = false) Integer page) throws Exception {
        ModelAndView modelAndView = new ModelAndView("blog/index");

        PageRequest pageRequest = PageRequest.of(page == null ? 0 : page - 1, 5, Sort.by("createDate").descending());

        List<Blog> blogList = blogService.getEnabledAll(pageRequest);
        Long total = blogService.total();

        modelAndView.addObject("blogs", blogList);
        modelAndView.addObject("total", total);

        return modelAndView;
    }

    @PostMapping("/list")
    @ResponseBody
    public MyResponse list(@RequestBody MyPageRequest pageRequest) {
        Map<String, Object> result = new HashMap<>();
        Long filterTotal = 0L;

        if(pageRequest.getConditionList() != null && pageRequest.getConditionList().size() > 0){
            filterTotal = this.blogService.filterTotal(pageRequest);
        }

        result.put("data", this.blogService.getAll(pageRequest));
        result.put("total", this.blogService.total());
        result.put("filterTotal", filterTotal);

        return MyResponse.success(result);
    }

    @PostMapping("/save")
    @ResponseBody
    public MyResponse save(@RequestBody Blog blog) {
        if(blog.getId() == null){
            blogService.save(blog);
        }else{
            blogService.update(blog);
        }

        return MyResponse.success();
    }

    @GetMapping("/del/{id}")
    @PreAuthorize("hasRole('ADMIN')")
    @ResponseBody
    public MyResponse delete(@PathVariable Long id) {
        blogService.deleteById(id);

        return MyResponse.success();
    }

    @GetMapping(name = "blog detail page", value = "/{id}")
    public ModelAndView blogDetail(@PathVariable Long id) throws JsonProcessingException {
        ModelAndView modelAndView = new ModelAndView("blog/detail");

        Blog blog = blogService.getById(id);
        int words = 0;

        if (blog.isEnabled()) {
            words = blog.getContent().length();
            modelAndView.addObject("blog", blog);
        } else {
            modelAndView.addObject("berr", true);
        }

        return modelAndView;
    }
}

```



å…·ä½“çš„æ–¹æ³•ä¿¡æ¯è¿™é‡Œå°±ä¸åˆ—å‡ºæ¥äº†ï¼Œç„¶åå°±å¯ä»¥åœ¨ **IDEA** é‡Œå¯åŠ¨ `App`ï¼Œå¯åŠ¨æˆåŠŸäº†ï¼Œå¯ä»¥æ‰“å¼€æµè§ˆå™¨è®¿é—® `localhost:8080/blog`ï¼Œé»˜è®¤ç«¯å£æ˜¯ 8080ï¼Œé»˜è®¤åµŒå…¥å¼ **Sever** æ˜¯ **Tomcat**ã€‚åˆ°æ­¤ï¼Œä¸€ä¸ªç®€å•çš„ **App** å°±æ„å»ºå®Œæˆäº†ï¼Œå¯ä»¥ä½¿ç”¨ **Maven** åœ¨å‘½ä»¤è¡Œè½»æ¾çš„æ‰“åŒ…æˆ `jar`ã€‚



## å®Œæ•´çš„ç›®å½•ç»“æ„

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œéƒ½æ²¡æœ‰ç”¨åˆ°  **`application.properties`** æˆ– **`application.yml`**ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•é™æ€æ–‡ä»¶ï¼Œhtmlã€jsã€css ç­‰ã€‚å®é™…é¡¹ç›®ä¸­ï¼Œå¦‚æœä½¿ç”¨çš„æ˜¯ **Maven**ï¼Œé‚£ä¹ˆæ ‡å‡†ç›®å½•ç»“æ„ [æˆ³è¿™é‡Œçœ‹ Maven å®˜æ–¹è¯´æ˜](https://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html)ã€‚

å¯¹äºä¸€ä¸ª **Web** åº”ç”¨æ¥è¯´ï¼Œhtml æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œ**Spring** ä¸æ¨èä½¿ç”¨ JSPï¼Œå› ä¸ºæœ‰ä¸€äº›é™åˆ¶:

* ä½¿ç”¨  **Jetty**ã€**Tomcat** æ—¶ï¼Œwar æ–‡ä»¶å¯ä»¥æ­£å¸¸è¿è¡Œã€‚å¯ä»¥é€šè¿‡ `java -jar blog.war` å‘½ä»¤å¯åŠ¨ï¼Œä¹Ÿå¯ä»¥éƒ¨ç½²åˆ°æ ‡å‡†çš„ç‹¬ç«‹çš„å®¹å™¨é‡Œï¼Œæ¯”å¦‚é€šè¿‡ **Tomcat** `bin` ç›®å½•ä¸‹çš„ `start.sh` å¯åŠ¨ï¼Œç„¶åæŠŠ **war** æ–‡ä»¶æ”¾åˆ° `webapps` ç›®å½•ä¸‹ã€‚å¦‚æœæ˜¯ **jar** æ–‡ä»¶ï¼Œé€šè¿‡ `java -jar blog.jar` å¯åŠ¨ï¼Œæ˜¯ä¸æ”¯æŒ **JSP** çš„ã€‚
* **Undertow** ä¸æ”¯æŒ **JSP**
* è‡ªå®šä¹‰çš„é”™è¯¯é¡µé¢ `error.jsp` ä¸èƒ½è¦†ç›–æ‰åº”ç”¨æœåŠ¡å™¨é»˜è®¤çš„é”™è¯¯é¡µé¢ã€‚å¦‚æœéœ€è¦é‡å†™é”™è¯¯é¡µé¢ï¼Œå¯ä»¥ [æˆ³è¿™é‡Œå‚è€ƒå®˜æ–¹æ–‡æ¡£](https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-error-handling-custom-error-pages)ã€‚



[æ›´åŠ è¯¦ç»†ä¿¡æ¯ï¼Œæˆ³è¿™é‡Œçœ‹å®˜æ–¹æ–‡æ¡£](https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-jsp-limitations)ã€‚è‡³äºè¯´å…¶å®ƒçš„æ¨¡æ¿å¼•æ“æ€ä¹ˆé€‰æ‹©ï¼Œè¿™å°±æ˜¯èåœé’èœå„æœ‰æ‰€çˆ±äº†ï¼Œç½‘ä¸Šä¹Ÿæœ‰å¥½å¤šæ¯”è¾ƒç©¶ç«Ÿæ˜¯ç”¨å“ªä¸ªæ¯”è¾ƒå¥½çš„è¿™ç§æ–‡ç« ï¼Œè‡ªå·±æƒè¡¡å§ï¼Œæœ¬ç«™ä½¿ç”¨ **Thymeleaf** æ˜¯å› ä¸ºå®ƒæ˜¯åŸºäº HTML çš„æ ‡ç­¾è¯­è¨€ï¼Œå¯ä»¥å’Œ HTML å¾ˆå¥½çš„ç»“åˆï¼Œå¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨é‡Œæ‰“å¼€æ¨¡æ¿æ–‡ä»¶ï¼Œå³ä½¿æ²¡æœ‰å€¼ä¹Ÿä¸ä¼šå¯¼è‡´ HTML ç»“æ„é”™è¯¯ï¼Œè€Œå…¶ä»–æ¨¡æ¿ä¸è¡Œã€‚æ€»ä¹‹ï¼Œæ²¡æœ‰æœ€å¥½ï¼Œåªæœ‰æœ€é€‚åˆã€‚

é»˜è®¤ **Spring** ä¼šåœ¨ `Class Path` ä¸‹ä»ä»¥ä¸‹ç›®å½•ä¸­å¯»æ‰¾æ¨¡æ¿æ–‡ä»¶ï¼š`/templates`ã€‚

é»˜è®¤ **Spring** ä¼šåœ¨ `Class Path` ä¸‹ä»ä»¥ä¸‹ç›®å½•ä¸­å¯»æ‰¾é™æ€èµ„æºï¼Œ`/static`ï¼Œ`/public`ï¼Œ`/resources`ï¼Œ`/META-INF/resources`ã€‚



> **æ‰€ä»¥ä¸€ä¸ªå®Œæ•´çš„ç›®å½•ç»“æ„çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š**

```html
blog
 +- src
    +- main
    		+- java
    		+- resources
    			+- static
    			+- templates
    			+- public
    			application.properties
					...
    +- test
			+- java
			+- ...
		
```

`static` ç›®å½•ä¸‹å¯ä»¥å­˜æ”¾æ‰€æœ‰é™æ€èµ„æºï¼Œæ¯”å¦‚ jsã€css ç­‰ï¼Œpublic ä¸‹å¯ä»¥å­˜æ”¾å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ç­‰ç­‰ã€‚

å½“ç„¶ï¼Œè¿™åªæ˜¯é»˜è®¤çš„é…ç½®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶æ¥æ›´æ”¹è‡ªå·±çš„è·¯å¾„ã€‚



## IDEA åˆ›å»º SpringBoot é¡¹ç›®

**IDEA** é›†æˆäº† **Spring Initialzr** å¯ä»¥æ–¹ä¾¿çš„åˆ›å»º **SpringBoot** é¡¹ç›®ï¼Œ[ğŸ‘‰ æˆ³è¿™é‡Œçœ‹è¯¦æƒ…](https://www.jetbrains.com/help/idea/spring-boot.html#top)ã€‚æœ‰ä¸€ä¸ªç§°å¿ƒå…¥æ‰‹çš„å¼€å‘å·¥å…·ï¼Œèƒ½ä½¿ä½ èº«å¿ƒæ„‰æ‚¦çš„è¿›è¡Œå¼€å‘ï¼Œåœ¨å¼€å‘è¿‡ç¨‹å½“ä¸­ï¼Œæœ¬æ¥å°±æœ‰å¾ˆå¤šæ¼äººçš„äº‹æƒ…ï¼Œä¸æƒ³åšå´ä¸å¾—ä¸åšçš„äº‹æƒ…ï¼Œå¾ˆå¤šäº‹é™¤éä½ è·³æ§½ï¼Œå¦åˆ™ä½ å°±å¿…é¡»æ¥å—ï¼Œé‚£ä¸ºä»€ä¹ˆä¸è®©è‡ªå·±æœ‰ä¸€ä¸ªå¼€å‘åˆ©å™¨æ¥æå‡è‡ªå·±çš„æ•ˆç‡ï¼Œè®©è‡ªå·±å¼€å¿ƒä¸€ç‚¹å‘¢ï¼Ÿåˆä¸ç”¨ä½ èŠ±é’±ï¼Œä¸ç”¨ä½ èŠ±å¤§é‡æ—¶é—´ï¼ŒèŠ±å‡ åˆ†é’Ÿå°±å¯ä»¥å¼€å§‹ç”¨äº†ï¼ŒèŠ±ä¸ªåå¤©åŠæœˆå°±ç†Ÿæ‚‰äº†ã€‚æ€»ä¹‹ï¼Œä» Eclipse è½¬åˆ° IDEAï¼Œå°±å¥½æ¯”ä»å®‰å“æ‰‹æœºè½¬åˆ°è‹¹æœæ‰‹æœºï¼Œåˆšå¼€å§‹å¯èƒ½ä¼šç”±äºé™Œç”Ÿè€Œä¸ä¹ æƒ¯ï¼Œç­‰ç”¨ç†Ÿäº†ï¼Œå°±å†ä¹Ÿä¸æƒ³å›å»äº†ã€‚å°±æ˜¯è¿™ç§æ„Ÿè§‰ï¼Œå—¯ï¼Œæ˜¯çš„ã€‚

æœ¬ç€èŠ‚çœçš„åŸåˆ™æœ¬ç«™ï¼Œå‡ ä¹ä¸ä½¿ç”¨å›¾ç‰‡æ¥ä¸¾ä¾‹ï¼Œå°½é‡ä½¿ç”¨å¤–é“¾åˆ°å®˜æ–¹åœ°å€ã€‚è€Œä¸”ï¼Œåšä¸»è®¤ä¸ºï¼Œå­¦ä»»ä½•ä¸€ä¸ªæ–°çš„ä¸œè¥¿æˆ–è€…å·¥å…·ï¼Œéƒ½éœ€è¦å…·æœ‰åŸºæœ¬çš„çŸ¥è¯†ï¼Œæ¯”å¦‚ç”¨ **SpringBoot**ï¼Œå¥¹æœ¬èº«åªæ˜¯ä¸€ä¸ªå·¥å…·ï¼Œä¸€ä¸ªæ¡†æ¶ï¼Œå¥¹åªæ˜¯è®©ä½ æ›´å¥½çš„ä½¿ç”¨ **Spring Frameworkï¼ŒSpring Securityï¼ŒSpring Data JPA** ç­‰ç­‰ï¼Œæ‰€ä»¥å‰æè¿˜æ˜¯éœ€è¦å…ˆå­¦ä¼šå¦‚ä½•ä½¿ç”¨è¿™äº›ä¸œè¥¿ï¼Œæ‰èƒ½ä½“ä¼šåˆ° **SpringBoot** å¸¦æ¥çš„å¥½å¤„ã€‚

æœ¬ç³»åˆ—æ•™ç¨‹ï¼Œä¼šç»“åˆ **SpringBoot** åœ¨æ¶‰åŠåˆ°æŸä¸€ä¸ªå…·ä½“çš„æ¡†æ¶æ—¶ï¼Œç»“åˆä¸¤è€…ä¼šæœ‰è¯¦ç»†çš„æè¿°ã€‚





